<<!DOCTYPE html>
<html>
<head>
	<meta charset=utf-8 />
	<title id="title">Security Cameras in Boone </title>
	<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.css" />
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.1/dist/leaflet.css" />
	<link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lora" rel="stylesheet">
  <script src="http://code.jquery.com/jquery-3.1.1.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
  integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
  crossorigin=""/>
  <!-- Make sure you put this AFTER Leaflet's CSS -->
  <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
    integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
    crossorigin=""></script>
	<script src='newPoints.js'></script>
	#use the css and js files from pyscript.net
<link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
<script defer src="https://pyscript.net/alpha/pyscript.js"></script>



<!-- Nice background-color from sonny rollins website : #3c3b4a -->
	<style>


	html {
		box-sizing: border-box;
	}
		body {
			margin: 0;
			padding: 0;
			background: #3c3b4a;
			font-family: "Noto Sans", sans-serif;
			color: #3d3d3d;
		}

		#map {
			position: absolute;
			top: 0;
			bottom: 0;
			width: 100%;
      height: 100%;
		}

	</style>
</head>

<body>

	<div id='map'></div>


<script>

//center viewport add zoom para
var options = {
//center edited to align with trail system
	center: [36.214909, -81.678954],
	zoom: 14.9,
	closePopupOnClick: true,
};
var circ_options = {
	color: "#ff3300",
	opacity: .8,
	fillColor: '#ff3300',
	radius: 10,
	fillOpacity: .9,
}

//creation of the Leaflet map
	const newPoints = [];

	var map = L.map('map', options);

  // prompt for adding secutity cameras
  var coordinates = L.popup();
	var output = L.popup();

	// start Out put
	function addCircle(e) {
		var coords = e.latlng.toString().replace('LatLng(','').replace(')','' );
		console.log(e.latlng.lat + ',' + e.latlng.lng);
		L.circle([e.latlng.lat,e.latlng.lng],circ_options)
			.addTo(map)
			.bindPopup(e.NAME);

		let nameInput = document.getElementById('camName').value;
		newPoints.push(nameInput +  coords);
		alert(newPoints);
			// need to add all of these to a list and append it on each click
			// addCircle works up i cant extend the e event to within the popup content

	};

  function onMapClick(e){
		var coords = e.latlng.toString().replace('LatLng(','').replace(')','' );
		// '</br></br>Add point feature? </br></br> <button id="yes" onClick="addCircle()">Yes</button> &nbsp <button onClick="map.closePopup()">No</button></br></br><textarea id="name">  </textarea>'

	 let pythonText = {'<py-script>
			import os
			nameInput = document.getElementById("camName")
			print(os.getcwd())
		</py-script>'};


		coordinates
          .setLatLng(e.latlng)
          .setContent(pythonText + '<br><input type="text" id="camName" placeholder="Double Click to Add Camera<br> "></input>&nbsp&nbsp&nbsp&nbsp&nbsp<button onClick="writeNewCircles()"),map.closePopup()">Enter</button><br>' + e.latlng.toString().replace('LatLng(' , '').replace(')',''))
          .openOn(map);


  };

  //map.on('click', onMapClick);

map.on('click' , onMapClick);
map.on('dblclick', addCircle);



function writeNewCircles(){
	let nameInput = document.getElementById('camName').value;
	console.log(nameInput , newPoints);
};



//request to load basemap



/*
ALTERNATE_TOPOBASEMAP
ESRI World Topographic
var Esri_WorldTopoMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community'
});
*/
/*
var USGS_USImageryTopo = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}', {
	maxZoom: 20,
	attribution: 'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'
}).addTo(map);
*/
// Esri Basemap has more zoom
var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
}).addTo(map);

//#0096FF is red
//#ff3300 is blue


//camera point features variables
var townHallCam1 = L.circle([36.217891, -81.682866], circ_options).addTo(map)

var hopeCenterCam1 = L.circle([36.218263, -81.685100] , circ_options).addTo(map)

var libraryEagle = L.circle([36.215189, -81.679876], circ_options).addTo(map)

// tooltips and information on each camera

townHallCam1.bindTooltip("<b>Cameras on Town Hall </b> </br> There's like three different cameras </br> aimed at the street, the sidewalk, </br> and the stop light on the awning of the Hall.").addTo(map)

hopeCenterCam1.bindTooltip('<b>The Hope Center</b> </br> This is the town "Pregnancy Services" clinic. </br> They monitor entry and exit from one </br> camera on the street mounted </br> on the door.').addTo(map)

libraryEagle.bindTooltip('<b> App State Library </b> </br> This camera resides above the coffee shop for the library. </br> Not sure which way it points... No access.').addTo(map)


</script>

</body>

</html>
